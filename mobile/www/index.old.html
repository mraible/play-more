<!DOCTYPE html>
<html>
<head>
    <title>Play More!</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;"/>
    <meta charset="utf-8">

    <link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/style.min.css"/>
    <script type="text/javascript" src="assets/js/modernizr-2.0.6.min.js"></script>

    <!-- iPad/iPhone specific css below, add after your main css >
    <link rel="stylesheet" media="only screen and (max-device-width: 1024px)" href="ipad.css" type="text/css" />
    <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="iphone.css" type="text/css" />
    -->
    <!-- If your application is targeting iOS BEFORE 4.0 you MUST put json2.js from http://www.JSON.org/json2.js into your www directory and include it here -->
    <script type="text/javascript" charset="utf-8" src="cordova-1.8.1.js"></script>
    <script type="text/javascript">
        // If you want to prevent dragging, uncomment this section
        /*
         function preventBehavior(e)
         {
         e.preventDefault();
         };
         document.addEventListener("touchmove", preventBehavior, false);
         */

        /* If you are supporting your own protocol, the var invokeString will contain any arguments to the app launch.
         see http://iphonedevelopertips.com/cocoa/launching-your-own-application-via-a-custom-url-scheme.html
         for more details -jm */
        /*
         function handleOpenURL(url)
         {
         // TODO: do something with the url passed in.
         }
         */

        function onBodyLoad() {
            document.addEventListener("deviceready", onDeviceReady, false);
        }

        /* When this function is called, PhoneGap has been initialized and is ready to roll */
        /* If you are supporting your own protocol, the var invokeString will contain any arguments to the app launch.
         see http://iphonedevelopertips.com/cocoa/launching-your-own-application-via-a-custom-url-scheme.html
         for more details -jm */
        function onDeviceReady() {
            $('#start,#reset').removeAttr('disabled');
            $('#loading').hide();
            $('#start').click(function() {
                StopWatch.start(this, $('#clock'));
                $('#app').show();
                Map.start();
                if ($('#no-music').is(':checked')) {
                    $("#player")[0].pause();
                }
            });
            $('#reset').click(function() {
                StopWatch.reset();
                Map.reset();
                $('#app').hide();
                $("#player")[0].currentTime = 0;
            });
            $('#no-music').click(function() {
                if ($("#no-music").is(":checked")) {
                    return $("#player")[0].pause();
                } else {
                    return $("#player")[0].play();
                }
            });
            $('#save').click(function() {
                $.ajax({
                    type: 'POST',
                    dataType: 'jsonp',
                    url: $('#save').attr('rel'),
                    data: {
                        'workout.id': '',
                        'workout.title': 'Skiing at Winter Park',
                        'workout.description': 'On a Blue Bird Day!',
                        'workout.duration': $('#clock').val(),
                        'workout.distance': $('#distance').text()
                    },
                    error: function() {
                        return alert('Posting failed, please try again.');
                    },
                    success: function(data) {
                        var alert, msg;
                        $('.alert-message').remove();
                        msg = 'Your workout was posted!';
                        alert = $('<div class="alert-message success fade in" data-alert="alert">');
                        alert.html('<a class="close" href="#">&times;</a>' + msg);
                        return alert.insertBefore($('.span10'));
                    }
                });
             });
        }
    </script>
</head>
<body class="home index" onload="onBodyLoad()">
<div class="topbar">
    <div class="fill">
        <div class="container">
            <a class="brand" href="/">
                <img class="logo" src="assets/images/play-more.png" width="32" height="32" alt="Play More!"/>
            </a>
            <ul class="nav" data-tabs="tabs">
                <li id="nav-index">
                    <a href="/">Play</a>
                </li>
                <li id="nav-profile">
                    <a href="/more">More</a>
                </li>
                <li id="nav-settings">
                    <a href="/music">Music</a>
                </li>
                <li id="nav-about">
                    <a href="/about">
                        <img src="assets/images/icon-info.png" class="icon" width="20" height="20"/>
                    </a>
                </li>
            </ul>
            <form action="" class="pull-right">
                <input class="input-small" type="text" placeholder="Username"/>
                <input class="input-small" type="password" placeholder="Password"/>
                <button class="btn" type="submit">Sign in</button>
            </form>
        </div>
    </div>
</div>
<div class="container">
    <div class="content">
        <div class="page-header">
            <h1>

                <small>

                </small>
            </h1>
        </div>
        <div class="row">
            <div class="span10">
                <div id="display">
                    <input id="clock" class="xlarge" type="text" value="00:00:00.0" readonly="readonly"/>
                </div>
                <div id="controls">
                    <button id="start" type="button" class="btn primary" disabled>Start</button>
                    <button id="reset" type="button" class="btn :disabled" disabled>Reset</button>
                    <div id="options"><input type="checkbox" id="no-music" checked> No Music Please</div>
                </div>
                <div id="loading"><img src="assets/images/ajax-loader.gif" alt="Loading"> Loading...</div>
                <div id="app" style="display: none">
                    <div id="track">
                        Distance Traveled: <span id="distance">0</span> mile(s)
                        <div id="actions">
                            <button id="save" type="submit" class="btn success"
                                rel="http://play-more.com/profile/postworkout">Save</button>
                        </div>
                    </div>
                    <div id="where">
                        <div id="map" class="odometer-map"></div>
                        <p id="location">
                            <span class="label success">New</span>
                            Fetching your location with HTML 5 geolocation...
                        </p>
                    </div>
                    <div id="music">
                        <audio controls="controls" id="player" preload="auto" autobuffer="true">
                            <source src="http://dl.dropbox.com/u/3486601/Music/Thunderstruck.ogg"
                                    type="audio/ogg"></source>
                            <source src="http://dl.dropbox.com/u/3486601/Music/Thunderstruck.mp3"
                                    type="audio/mp3"></source>
                            Your browser does not support the audio tag.
                        </audio>
                    </div>
                </div>
            </div>
            <div class="span4">

            </div>
        </div>
    </div>
    <footer>
        <p>&copy; <span class="copy-year">2012</span> <a href="http://raibledesigns.com">Raible Designs</a></p>
    </footer>
</div>
<script type="text/javascript" src="assets/js/zepto.min.js"></script>
</script>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="assets/js/map.js"></script>
<script type="text/javascript" src="assets/js/stopwatch.js"></script>
<script type="text/javascript" src="assets/js/odometer.js"></script>
<script type="text/javascript" src="assets/js/playmore.js"></script>
<script type="text/javascript" src="assets/js/bootstrap-alerts.js"></script>
<script type="text/javascript" src="assets/js/bootstrap-tabs.js"></script>
<script type='text/javascript'>
    //<![CDATA[
    window._gaq = [
        ['_setAccount','UA-25859875-1'],
        ['_trackPageview'],
        ['_trackPageLoadTime']
    ];
    Modernizr.load({
        load: ('https:' == location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js'
    });
    $('.nav').tabs()
    var year = (new Date()).getFullYear();
    if (year > 2011) {
        $('.copy-year').html(year);
    }
    //]]>
</script>
</body>
</html>